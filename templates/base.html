{% load bootstrap %}
{% load index_extras %}
{% load url from future %}

<!DOCTYPE html>
<html lang="en" style="height:100%;">
  <head>
    <title>{% block title %}{% endblock %} | StyleMatch</title>
    <meta charset="utf-8" />
    <meta name="robots" content="NOODP">
    {% block meta-tag-image %}
    <meta property="og:image" content="{{ STATIC_URL }}img/logga-facebook-liten.png">
    {% endblock %}{# meta-tag-image #}
    {% facebook %}
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="{{ STATIC_URL }}js/bootstrap-alert.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/bootstrap-tooltip.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/bootstrap-dropdown.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/noty/js/jquery.noty.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/jquery.noty.custom.js" type="text/javascript"></script>
    {% intercom_analytics %}
    <script id="IntercomSettingsScriptTag">
      {% comment %} Intercom.io settings {% endcomment %}
      var intercomSettings = {
      app_id: 'k27ag4y',
      email: '{{ user.email }}',
      created_at: '{{ user.date_joined }}',
      };
    </script>

    <script type="text/javascript">
      $('.dropdown-toggle').dropdown({trigger:'hover'});

      /* Function to trigger tooltip when clicked and hide after a delay*/
      $(document).ready(function() {
      var defaultOption={trigger:'manual', delay: {hide: 500 }};
      function showAndHidePopover() {
      $(this).tooltip('toggle');
      var self = this;
      setTimeout(function() {
      $(self).tooltip('hide');
      }, 4000);
      };

      {# TODO: Move this to where it is actually needed. #}
      {# It's throwing exceptions in pages where .popover1 doesn't exists. #}
      $('.popover1').tooltip(defaultOption).click(showAndHidePopover);

      });

      function goToByScroll(id){
        $('html,body').delay(1500).animate({scrollTop: $("#"+id).offset().top},'slow');
      }

      function indexredirect() {
        {% url 'index_page' as index %}
        {% if request.path != index %}
        window.setTimeout(function() {
          window.location = '{% url 'index_page' as index %}{{index}}';
        }, 1500);
        {% endif %}
      };
    </script>

    {% block pre-bootstrap-less %}{% endblock %}
    {% bootstrap_less %}

    {# Used to load js and css that's specific to a page. Should add a block for js at end of this file for javascript #}
    {% block html-head %}{% endblock %}

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

    <!-- This meta-tag shows facebook we are stylematch on facebook --> 
    <meta property="fb:admins" content="637077638" />
    <meta property="fb:app_id" content="309825002426259" />
  </head>

  <body class="body-padding-zero" data-spy="scroll" data-target=".subnav" data-offset="50" data-twttr-rendered="true">

    {% if user.is_authenticated %}{# Add menubar at top #}
      <div style="padding:19px;"></div>
      {% include "authenticated_menu.html" %}
    {% endif %}

    <div class="bigpage{% url 'index_page' as index %}{% ifequal request.path index %} bg-firstpage{%endifequal %}">

{# This tag is for pages that don't need the links in the header, for an example on how to use, see the signup-steps. #}
      {% block remove-links-top %}
      <div class="container header">
      {% if not user.is_authenticated %}

        <div class="row" style="margin:2px;">
          <div class="span3 offset9 pull-right top-right-menu">
            <a class="pull-right" href="{% url 'auth_login' %}">Logga in</a>
            <a class="top-menu-border pull-right" href="{% url 'registration_register' %}">Bli medlem som frisör</a>
          </div>
        </div>

        <div class="row masthead">
          <div class="span4">
            <a href="{% url 'index_page' as index %}{{ index }}"><img src="{{STATIC_URL}}img/logo.png"/></a>
          </div>
          <div class="span7 main-menu">
            <a href="#"
               class="popover1"
               rel="tooltip"
               data-content=""
               data-original-title="Kommer snart! Använd sökblocket på förstasidan tills vidare"
               onclick="indexredirect()">
                 Hitta frisör
            </a>
            <a href="#"  class="popover1" rel="tooltip" data-content="" data-original-title="Kommer snart" onclick="goToByScroll('test')">Bli inspirerad </a>
            <a href="{% url 'about_page' as about %}{{ about }}">Om Stylematch</a>
          </div>
        </div>{# row masthead #}
      {% endif %}
      </div>{# container #}
      {% endblock %} {# remove-links-top #}

      {% block second-background %}
      <div class="content-background">
      {% endblock %}{# second-backround #}

        <div class="container content">
          {% block content %}{% endblock %}
        </div>
      </div>{# content-background #}

    </div>{# bigpage??? #}

    {# this block-tag is used to have different background-colors on a page #}
    {% block second-background-another-color %}
    {% endblock%}

    {% block footer %}{% include 'base_footer.html' %} {% endblock %}

    {% block javascript-block %}
    {% endblock %}

    {# GOOGLE ANALYTICS #}
    <script type="text/javascript">
    var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-31224755-1']);
      // custom variables  
      _gaq.push(['_setCustomVar', 1, 'Current User', '{{ user.first_name }}', 1]);  
      _gaq.push(['_setCustomVar', 2, 'Current User ID', '{{ user.id }}', 1]);                                 
      _gaq.push(['_setCustomVar', 3, 'Record Owner ID', '101', 3]);  
      _gaq.push(['_setCustomVar', 4, 'Record Type', 'Job', 3]);  
      _gaq.push(['_setCustomVar', 5, 'Record ID', '87', 3]);  
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    {% google_analytics %}
    {# END GOOGLE ANALYTICS #}

    <!-- begin olark code --><script data-cfasync="false" type='text/javascript'>/*{literal}<![CDATA[*/
window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){f[z]=function(){(a.s=a.s||[]).push(arguments)};var a=f[z]._={},q=c.methods.length;while(q--){(function(n){f[z][n]=function(){f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={0:+new Date};a.P=function(u){a.p[u]=new Date-a.p[0]};function s(){a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{b.contentWindow[g].open()}catch(w){c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{var t=b.contentWindow[g];t.write(p());t.close()}catch(x){b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
/* custom configuration goes here (www.olark.com/documentation) */
olark.identify('3421-905-10-8470');/*]]>{/literal}*/</script><noscript><a href="https://www.olark.com/site/3421-905-10-8470/contact" title="Contact us" target="_blank">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript><!-- end olark code -->

  </body>
</html>
